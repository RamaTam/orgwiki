<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ch" xml:lang="ch">
<head>
<title>ArchLinux安装配置OpenGL</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="ArchLinux安装配置OpenGL"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-10-18 14:49:13 CST"/>
<meta name="author" content="Joseph Pan"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style><link rel="stylesheet" href="./other/style.css" type="text/css"/>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="./opengl_index.html"> UP </a>
 |
 <a accesskey="H" href="./index.html"> HOME </a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">ArchLinux安装配置OpenGL</h1>



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 前言</a></li>
<li><a href="#sec-2">2 安装 OpenGL</a></li>
<li><a href="#sec-3">3 编译示例程序</a></li>
<li><a href="#sec-4">4 不用写Makefile也能编译</a></li>
<li><a href="#sec-5">5 glut弹出菜单无法显示？</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 前言</h2>
<div class="outline-text-2" id="text-1">


<p>
在Linux安装配置OpenGL理论上是一件非常轻松的事情，因为OpenGL本身就是跨平台的东西。但我在看 OpenGL SuperBible 4th Edition 的时候，却总是遇到一些让我郁闷的事情：自带的GLTools类包只能在Windows和Mac OSX下使用，而且还得自己写Makefile。后来到网上找解决方法，才发现 SuperBible 已经早已经出到了 5th Edition，并且加入了对Linux的支持。
</p>
<p>
这给我两大教训：
</p>
<ol>
<li>当书中的内容有所欠缺的时候，应该及时去看官网，看看有没有发布新的版本，而不是自己在一旁摸索解决方法。
</li>
<li>不要总指望网上能够下载到电子版本，能够下载的大多数是Out of Date的。索性网购了一本纸质版<sup><a class="footref" name="fnr.1" href="#fn.1">1</a></sup>。
</li>
</ol>


</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 安装 OpenGL</h2>
<div class="outline-text-2" id="text-2">


<p>
  将第五版书中的代码下载下来：
</p>



<pre class="src src-sh">$ svn checkout http://oglsuperbible5.googlecode.com/svn/trunk/ oglsuperbible5-read-only
</pre>


<p>
  得到如下的目录树：
</p>
<pre class="example">
      
   oglsuperbible5-read-only/    # OpenGL SuperBible 5th Edition 代码包
   |                                                                  
   +--  freeglut-2.6.0/         # freeglut 安装包                     
   |                                                                  
   +--  Linux/                  # Linux Makefile 工程文件
   |     |                                               
   |     +----  Chap01/                                  
   |     |        |                                      
   |     |        +---- Block/                           
   |     |                |                              
   |     |                +---- Makefile # Block 程序的Makefile
   |     |                                                     
   |     +----  Chap02/                                        
   |     |                                                     
   |     +----  ...                                            
   |     |                                                     
   |     +----  Chap15/                                        
   |                                                           
   +--  Src/                   # 源代码                                                
   |     |                                                     
   |     +----  Chap01/                                        
   |     |        |                                            
   |     |        +---- Block/                                 
   |     |                |                                    
   |     |                +---- Block.cpp # Block 程序源文件
   |     |                                                  
   |     +----  Chap02/                                     
   |     |                                                  
   |     +----  ...                                         
   |     |                                                  
   |     +----  Chap15/                                     
   |     |                                                  
   |     +----  GLTools/      # GLTools工具包               
   |     |        |                                         
   |     |        +---- include/  # 头文件                  
   |     |        |      |                                  
   |     |        |      +----  GL/                         
   |     |        |      |                                  
   |     |        |      +----  GLTools.h # GLTools头文件   
   |     |        |      |                                  
   |     |        |      +----  math3d.h  # 矩阵类头文件    
   |     |        |      |                                  
   |     |        |      +----  ...                         
   |     |        |                                         
   |     |        +---- src/     # 源文件                   
   |     |               |                                  
   |     |               +---- GLTools.cpp # GLTools头文件  
   |     |               |                                
   |     |               +---- math3d.cpp  # 矩阵类源文件
   |     |               |                               
   |     |               +---- ...                       
   |     |                                               
   |     +----  Models/                                  
   |     |                                               
   |     +----  OpenEXR/                                 
   |                                                     
   +--  VisualStudio2008/    # VisualStudio 2008 工程文件
   |                                                     
   +--  VisualStudio2010/    # VisualStudio 2010 工程文件
   |                                                     
   +--  XCode/               # XCode 工程文件

</pre>


<p>
  可以看到开发OpenGL必须的freeglut包已经给出，进入该目录内安装freeglut：
</p>



<pre class="src src-sh">$ cd oglsuperbible5-read-only/freeglut-2.6.0
$ ./autogen.sh
$ ./configure
$ make
</pre>


<p>
  完成后，建议把帮助文档也装上：
</p>



<pre class="src src-sh">$ pacman -S opengl-man-pages <span style="color: #ffd700;"># </span><span style="color: #ffd700;">&#21487;&#33021;&#38656;&#35201;root&#26435;&#38480;</span>
</pre>


<p>
  这样，当需要获取帮助的时候，可以直接使用man查询，例如要查看 <code>glVertex</code> 函数的帮助，可以：
</p>



<pre class="src src-sh">$ man glvertex
</pre>


<p>
  另外，为了方便Emacs或其他编辑器能够解析GLTools的Semantic，还可以用 <code>cp</code> 命令把GLTools的文件复制到系统文件夹中。
</p>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> 编译示例程序</h2>
<div class="outline-text-2" id="text-3">


<p>
  要编译代码包提供的示例程序，直接在 <b>Linux</b> 目录下找到相应的工程Makefile，然后 <code>make</code> 编译即可。关于Makefile的规则，推荐阅读陈皓编写的《<a href="http://wiki.ubuntu.org.cn/%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E5%86%99Makefile">跟我一起写Makefile</a>》。
</p>
</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> 不用写Makefile也能编译</h2>
<div class="outline-text-2" id="text-4">


<p>
  如果是自己编写的源文件，每次都要写一个Makefile显得太过繁琐<sup><a class="footref" name="fnr.2" href="#fn.2">2</a></sup>，这里给出一个方法<sup><a class="footref" name="fnr.3" href="#fn.3">3</a></sup>，可以让你不用编写Makefile即可直接编译程序。
</p>
<p>
  将下面的代码保存为一个脚本 <b>opengl</b> ：
</p>



<pre class="src src-sh"><span style="color: #ffd700;">#</span><span style="color: #ffd700;">!/bin/</span><span style="color: #00ffff; font-weight: bold;">sh</span><span style="color: #ffd700;"> </span>
g++ $<span style="color: #ffd700; font-style: italic;">1</span> -I GLTools/include/GL -I GLTools/include/ -I GLTools/src/ -I /usr/include -I /usr/local/include -I /usr/include -L /usr/X11R6/lib -L /usr/X11R6/lib64 -L /usr/local/lib -lX11 -lglut -lGL -lGLU -lm -o ${<span style="color: #ffd700; font-style: italic;">1</span>%.*}
</pre>


<p>
  保存后，赋予它执行权限：
</p>



<pre class="src src-sh">$ sudo chmod +x opengl
</pre>


<p>
  可以看到脚本中引用了几个目录中的文件，所以需要将代码包中的 <b>Src</b> 目录下的 <b>GLTools</b> 目录拷贝到这个文件夹中来，即保证你的目录树是这样的：
</p>
<pre class="example">
    
    program
       |
       +---- GLTools/      # GLTools工具包
       |       |
       |       +---- include/  # 头文件
       |       |      |
       |       |      +----  GL/
       |       |      |
       |       |      +----  GLTools.h # GLTools头文件
       |       |      |
       |       |      +----  math3d.h  # 矩阵类头文件
       |       |      |
       |       |      +----  ...
       |       |
       |       +---- src/     # 源文件
       |              |
       |              +---- GLTools.cpp # GLTools头文件
       |              |
       |              +---- math3d.cpp  # 矩阵类源文件
       |              |
       |              +---- ...
       |
       +---- opengl     # opengl脚本
       |                            
       +---- ...        # 你编写的源文件（*.cpp）


</pre>


<p>
  然后就可以同个文件夹下编写程序，要保证每个程序的头部引入必要的头文件：
</p>



<pre class="src src-c"><span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLTools.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLShaderManager.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLFrustum.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLBatch.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLMatrixStack.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLGeometryTransform.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;StopWatch.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;glew.c&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLTools.cpp&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLShaderManager.cpp&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLBatch.cpp&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GLTriangleBatch.cpp&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;math3d.cpp&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;math.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;stdio.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;StopWatch.h&gt;</span>

<span style="color: #00ffff; font-weight: bold;">#ifdef</span> __APPLE__
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;glut/glut.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#else</span>
<span style="color: #00ffff; font-weight: bold;">#define</span> <span style="color: #ffd700; font-style: italic;">FREEGLUT_STATIC</span>
<span style="color: #00ffff; font-weight: bold;">#include</span> <span style="color: #f0e68c;">&lt;GL/glut.h&gt;</span>
<span style="color: #00ffff; font-weight: bold;">#endif</span>
</pre>


<p>
  编写完后，使用下面的命令编译程序：
</p>



<pre class="src src-sh">$ ./opengl &#25991;&#20214;&#21517;.cpp
</pre>


</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> glut弹出菜单无法显示？</h2>
<div class="outline-text-2" id="text-5">


<p>
  如果遇到 <code>glutCreateMenu</code> 函数生成的弹出菜单无法显示的问题，可能是freeglut的版本太高的原因。我一开始是使用yaourt命令安装freeglut的，安装的版本是2.8.0，就存在这个问题。
</p>
<p>
  解决的方法就是downgrade之：
</p>



<pre class="src src-sh">$ wget http://arm.konnichi.com/extra/os/{i686|x86_64}/freeglut-2.6.0-1-{i686|x86_64}.pkg.tar.gz
$ pacman -U ./freeglut-2.6.0-1-{i686|x86_64}.pkg.tar.gz <span style="color: #ffd700;"># </span><span style="color: #ffd700;">&#21487;&#33021;&#38656;&#35201;root&#26435;&#38480;</span>
</pre>



<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">
<p class="footnote"><sup><a class="footnum" name="fn.1" href="#fnr.1">1</a></sup> 其实我喜欢电子版本的原因是可以方便的复制书中的内容，这对我做笔记很有用。另外由于电脑屏幕够大，所以在Awesome下可以直接开Emacs和evince两个窗口，一边看书一边动手，非常顺手。
</p>


<p class="footnote"><sup><a class="footnum" name="fn.2" href="#fnr.2">2</a></sup> 当然，编写一个通用的Makefile不是不可能，但对于新手来说要花费不少时间。
</p>


<p class="footnote"><sup><a class="footnum" name="fn.3" href="#fnr.3">3</a></sup> 出自：<a href="http://www.jayrambhia.com/geek/article.php/GLtools_for_OpenGL">http://www.jayrambhia.com/geek/article.php/GLtools\_for\_OpenGL</a>
</p></div>
</div>

</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2012-10-18 14:49:13 CST</p>
<p class="author">Author: Joseph Pan</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
